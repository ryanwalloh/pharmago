# Pharmago - Medicine Delivery Platform

A full-stack medicine delivery platform built with Django backend, React frontend, and PostgreSQL database, all containerized with Docker. Think of it as "Foodpanda for Medicine" - connecting customers with pharmacies through rider delivery services.

## 🏥 Platform Overview

**Pharmago** is a comprehensive medicine delivery system that includes:
- **Customers**: Order medicines online from nearby pharmacies
- **Pharmacies**: Manage inventory and fulfill orders
- **Riders**: Deliver medicines to customers
- **Admin**: Oversee the entire platform operations

## 🚀 Quick Start

### Prerequisites
- [Docker](https://docs.docker.com/get-docker/) (version 20.10 or higher)
- [Docker Compose](https://docs.docker.com/compose/install/) (usually comes with Docker Desktop)
- Git

### 1. Clone the Repository
```bash
git clone https://github.com/ryanwalloh/pharmago
cd pharmago
```

### 2. Build and Start All Services
```bash
docker-compose up --build
```

This command will:
- Build Docker images for backend and frontend
- Start PostgreSQL database
- Start Django backend API
- Start React frontend
- Start pgAdmin (optional database management tool)

### 3. Create Your Django Admin User
**Important**: Each developer needs to create their own admin account!

```bash
docker-compose exec backend python manage.py createsuperuser
```

Follow the prompts to create:
- **Username**: Choose your preferred username
- **Email**: Enter your email address
- **Password**: Create a strong password (you'll type it twice)

**Note**: This creates an admin user only for your local machine. Your partner will need to create their own admin account when they set up the project.

### 4. Access Your Application
Once all services are running, you can access:

- **Frontend**: http://localhost:3000
- **Backend API**: http://localhost:8000
- **Django Admin**: http://localhost:8000/admin (use your superuser credentials)
- **pgAdmin**: http://localhost:5050 (admin@local.dev / admin123)
- **Database**: localhost:5432

## 🔄 Git Workflow & Branching Strategy

### Branch Structure
```
main (production/stable)
    ↓
develop (integration branch - DEFAULT)
    ↓
feature/* (individual features)
```

### Branch Protection Rules
- **`main`**: Protected - requires PRs and approvals
- **`develop`**: Protected - requires PRs and approvals  
- **`feature/*`**: No protection - safe development environment

###  CRITICAL REMINDERS

#### ⚠️ ALWAYS PULL FIRST!
```bash
# BEFORE starting any work, ALWAYS:
git checkout develop
git pull origin develop

# THEN create your feature branch
git checkout -b feature/your-feature-name
```

#### ⚠️ NEVER WORK DIRECTLY ON MAIN OR DEVELOP!
- **Main**: Production code only - never edit directly
- **Develop**: Integration branch - never edit directly
- **Feature branches**: Safe to edit and commit

#### ⚠️ ALWAYS CREATE PRs FOR MERGES!
- **Direct pushes to main/develop are BLOCKED**
- **All changes must go through Pull Requests**
- **Wait for approval before merging**

### Development Workflow

#### 1. **Start from develop branch (ALWAYS PULL FIRST!)**
```bash
git checkout develop
git pull origin develop  # ⚠️ CRITICAL: Get latest changes
```

#### 2. **Create feature branch**
```bash
git checkout -b feature/your-feature-name
# Examples:
# git checkout -b feature/user-authentication
# git checkout -b feature/pharmacy-management
# git checkout -b feature/order-system
```

#### 3. **Develop your feature**
- Write code, test locally
- Make commits as you progress
- Keep commits focused and descriptive

#### 4. **Commit your changes**
```bash
git add .
git commit -m "Add user login functionality with JWT authentication"
```

#### 5. **Push feature branch**
```bash
git push origin feature/your-feature-name
```

#### 6. **Create Pull Request**
- Go to GitHub repository
- Click "Compare & pull request" for your feature branch
- **Target branch**: `develop` (not main!)
- Add descriptive title and description
- Click "Create pull request"

#### 7. **Review and Merge**
- **Repository owner reviews** the PR
- **Approve** the changes
- **Merge** into develop branch
- **Delete feature branch** when prompted

### Example Feature Development

```bash
# 1. ALWAYS start from develop and PULL FIRST
git checkout develop
git pull origin develop

# 2. Create feature branch
git checkout -b feature/medicine-catalog

# 3. Work on your feature
# ... code, test, code, test ...

# 4. Commit changes
git add .
git commit -m "Add medicine catalog with search and filtering"

# 5. Push feature branch
git push origin feature/medicine-catalog

# 6. Create PR on GitHub: feature/medicine-catalog → develop
# 7. Wait for review and approval
# 8. After merging, delete feature branch
```

### Important Rules

✅ **ALWAYS pull develop first** before creating feature branches  
✅ **Feature branches target develop** (not main)  
✅ **Create descriptive branch names**: `feature/user-login`, `feature/pharmacy-dashboard`  
✅ **Write clear commit messages**: "Add user authentication system"  
✅ **Create PRs for all changes** to develop or main  
✅ **Wait for approval** before merging  
❌ **NEVER work directly on main or develop**  
❌ **NEVER skip the pull step**  

### What Happens After Merging

#### Feature → Develop:
- Your feature is now part of the integration branch
- Other features can be developed and tested together
- Develop branch contains all approved features

#### Develop → Main (Release):
- When ready for production release
- Repository owner merges develop into main
- Main branch gets all tested features
- Production deployment can happen

## 📚 Git Commands Cheatsheet

### 🔍 Status & Information
```bash
git status                    # Check current status
git branch                    # List local branches
git branch -a                 # List all branches (local + remote)
git log --oneline            # View commit history (compact)
git log --graph --oneline    # View commit history with graph
git remote -v                # Check remote repository URLs
```

###  Branch Management
```bash
git checkout develop          # Switch to develop branch
git checkout -b feature/name  # Create and switch to new feature branch
git branch -d feature/name    # Delete local feature branch
git branch -D feature/name    # Force delete local feature branch
git push origin --delete feature/name  # Delete remote feature branch
```

### 📥 Getting Latest Changes
```bash
git pull origin develop       # Pull latest develop changes
git fetch origin              # Fetch latest changes (doesn't merge)
git fetch --all               # Fetch from all remotes
```

### 📤 Pushing Changes
```bash
git push origin feature/name  # Push feature branch to remote
git push -u origin feature/name  # Push and set upstream (first time)
git push                      # Push current branch (if upstream set)
```

###  Committing Changes
```bash
git add .                     # Stage all changes
git add filename              # Stage specific file
git commit -m "Message"       # Commit with message
git commit --amend            # Amend last commit
git reset --soft HEAD~1       # Undo last commit (keep changes staged)
```

###  Merging & Rebasing
```bash
git merge develop             # Merge develop into current branch
git rebase develop            # Rebase current branch on develop
git rebase -i HEAD~3          # Interactive rebase last 3 commits
```

###  Emergency Commands
```bash
git stash                     # Stash current changes temporarily
git stash pop                 # Apply stashed changes
git reset --hard HEAD         # Reset to last commit (DESTROYS changes!)
git reset --soft HEAD~1       # Reset to last commit (keeps changes)
git checkout -- filename      # Discard changes in specific file
```

### 🧹 Cleanup Commands
```bash
git clean -fd                 # Remove untracked files and directories
git gc                        # Garbage collect (cleanup)
git prune                     # Remove unreferenced objects
```

### 📋 Useful Aliases (Add to ~/.gitconfig)
```bash
[alias]
    st = status
    co = checkout
    br = branch
    ci = commit
    lg = log --oneline --graph
    last = log -1 HEAD
    unstage = reset HEAD --
```

## 🛠️ Development Commands

### View Running Services
```bash
docker-compose ps
```

### View Logs
```bash
# All services
docker-compose logs

# Specific service
docker-compose logs backend
docker-compose logs web
```

### Stop All Services
```bash
docker-compose down
```

### Restart a Specific Service
```bash
docker-compose restart web
docker-compose restart backend
```

### Access Container Shell
```bash
# Frontend container
docker-compose exec web bash

# Backend container
docker-compose exec backend bash
```

## Project Structure

```
This is not Final, just a prototype
pharmago/
├── backend/                 # Django backend API
│   ├── api/                # Django app with models for:
│   │   ├── customers/      # Customer management
│   │   ├── pharmacies/     # Pharmacy profiles & inventory
│   │   ├── medicines/      # Medicine catalog
│   │   ├── orders/         # Order processing
│   │   ├── riders/         # Rider management
│   │   └── admin/          # Admin dashboard
│   ├── manage.py           # Django management
│   └── Dockerfile          # Backend container
├── web-frontend/           # React frontend
│   ├── src/                # React source code
│   │   ├── components/     # Reusable UI components
│   │   ├── pages/          # Page components
│   │   ├── services/       # API integration
│   │   └── utils/          # Helper functions
│   ├── package.json        # Node.js dependencies
│   └── Dockerfile          # Frontend container
├── mobileapp/              # Future mobile app
├── docker-compose.yml       # Service orchestration
└── README.md               # This file
```

## 🔧 Common Issues & Solutions

### Port Already in Use
If you get port conflicts, you can modify the ports in `docker-compose.yml`:
```yaml
ports:
  - "3001:3000"  # Change 3001 to any available port
```

### Container Won't Start
```bash
# Check logs for errors
docker-compose logs [service-name]

# Rebuild containers
docker-compose down
docker-compose up --build
```

### Database Connection Issues
- Ensure PostgreSQL container is running: `docker-compose ps`
- Check backend logs: `docker-compose logs backend`
- Verify database credentials in `backend/.env`

### Frontend Not Loading
- Check if web container is running: `docker-compose ps`
- View web logs: `docker-compose logs web`
- Ensure port 3000 is not blocked by firewall

### Django Admin Not Working
- Ensure you've created a superuser: `docker-compose exec backend python manage.py createsuperuser`
- Check backend is running: `docker-compose ps`
- Verify you're using the correct credentials

### Git Workflow Issues
- **Wrong target branch**: Make sure PRs target `develop` (not main)
- **Branch protection**: Feature branches don't need protection
- **Merge conflicts**: Always pull latest develop before creating feature branches
- **Forgot to pull**: If you forgot, stash changes, pull, then continue

## 🚀 Adding New Features

### Frontend (React)
```bash
# Access web container
docker-compose exec web bash

# Install new packages
npm install package-name

# The container will auto-reload changes
```

### Backend (Django)
```bash
# Access backend container
docker-compose exec backend bash

# Run Django commands
#Run the docker-compose exec backend bash before you can run the commands below
python manage.py makemigrations
python manage.py migrate
python manage.py createsuperuser
```

## 📝 Environment Variables

### Backend (.env file)
Create a `backend/.env` file with:
```env
DEBUG=True
SECRET_KEY=your-secret-key
DATABASE_URL=postgresql://superpharmago:pharmagoldenkey@postgres:5432/pharmago
```

### Frontend
Frontend environment variables are set in `docker-compose.yml` and will automatically use the backend API.

## 🧪 Testing

### Run Tests
```bash
# Backend tests
docker-compose exec backend python manage.py test

# Frontend tests
docker-compose exec web npm test
```

## 📦 Deployment

### Production Build
```bash
# Build production images
docker-compose -f docker-compose.prod.yml up --build
```

## 🤝 Contributing

### For Repository Owner (You):
1. Review PRs from `feature/*` → `develop`
2. Approve and merge features into develop
3. When ready: merge `develop` → `main` for releases

### For Contributors (Your Partner):
1. **ALWAYS pull develop first** before creating feature branches
2. Create feature branches from `develop`
3. Develop features independently
4. Create PRs targeting `develop`
5. Wait for review and approval
6. After merging, delete feature branches

## 🏥 Business Logic Notes

### Order Flow
1. Customer browses medicines and places order
2. System assigns order to nearest available pharmacy
3. Pharmacy confirms order and prepares medicines
4. System assigns rider for delivery
5. Rider picks up and delivers to customer
6. Order completion and rating system

### Key Models
- **User**: Base user model with role-based permissions
- **Pharmacy**: Location, inventory, operating hours
- **Medicine**: Name, description, price, stock, pharmacy
- **Order**: Customer, pharmacy, medicines, status, delivery
- **Rider**: Location, availability, current orders

## 📞 Support

If you encounter issues:
1. Check the logs: `docker-compose logs [service-name]`
2. Ensure Docker is running
3. Verify all ports are available
4. Check the troubleshooting section above
5. **For Django Admin issues**: Ensure you've created a superuser account
6. **For Git workflow issues**: Follow the branching strategy above
7. **For merge conflicts**: Always pull latest develop first

## 📚 Useful Links

- [Docker Documentation](https://docs.docker.com/)
- [Django Documentation](https://docs.djangoproject.com/)
- [React Documentation](https://reactjs.org/docs/)
- [Tailwind CSS Documentation](https://tailwindcss.com/docs)
- [Git Flow Guide](https://nvie.com/posts/a-successful-git-branching-model/)
- [Git Cheat Sheet](https://education.github.com/git-cheat-sheet-education.pdf)

---

**Building the future of medicine delivery! 💊**
